---
title: 元旦安恒月赛
date: 2020-01-02 14:29:54
tags:
 - 安恒月赛2020
 - ctf
 - wp
---

## 安恒元旦月赛

自己就看了这两个题目，其他都是队友解的。

<!--more-->

### MISC

#### 爆破鬼才

首先爆破第一个密码（队友已经爆破出来了）abc123

解压后还是一个压缩包

![](/pic/6.png)

发现`1.txt、2.txt、3.txt`长度不长，应该是要进行CRC32碰撞，附上渣渣脚本

```python
#coding:utf-8
import zipfile
import string
import binascii

dic=string.printable
crc = 0x7d90ee19   
for i in dic :
    for j in dic:
        for p in dic:
            for q in dic:
                s=str(i)+str(j)+str(p)+str(q)
                if crc == (binascii.crc32(s) & 0xffffffff):
                    print  s
```

这个是计算1.txt的，计算另外两个只要把crc改一下，删除连个for循环就好

最后得到的结果是`Blowitup`，打开压缩包，hint.txt中的内容是`guess out my birthday! `，各种百度找它的生日，找到后提交发现都是错误的。最后提示是答案不是生日，队友提示可能是[`outguess`](https://github.com/crorvick/outguess)加密。开始猜测密码，试了好几个都不是。开始写shell脚本（之前没有学），先跑了一遍2012年的没有正确的，改写脚本时，队友已经跑了出来。队友直接用`os.system`跑，从而避免重新学shell脚本。结论：队友太厉害，我太菜。

最后跑出来的密码是20140224。拿着key解密

得到`flag:flag{8322e7eed667c69f27ecbea5f96d86ca}`

### web

#### web1

是一个小游戏，话不多说开始玩一把。

![](/pic/7.png)

玩了一把后查看源码，发现有一个js。

```html
<!DOCTYPE html>
<html >
<head>
<meta charset="UTF-8">
<title>JS Planet defense game</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css">
<link rel="stylesheet" href="css/style.css">
</head>

<body>
<body>
<canvas id="canvas"></canvas>

</body>
<script src="js/index.js"></script>

</body>
</html>

```

点进去拉到最后有几条提示

![](/pic/8.png)

生成一个http请求，将分数发到服务器，将结果显示。

既然要生成请求，直接上`burp suite`，会发送一个record

```
POST /f1ag.php HTTP/1.1
Host: 183.129.189.60:10001
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-type: application/x-www-form-urlencoded
Content-Length: 9
Origin: http://183.129.189.60:10001
Connection: close
Referer: http://183.129.189.60:10001/

record=23
```

将`record`改成`99999999999999999999999999999999999999999999999999`，即可拿到flag